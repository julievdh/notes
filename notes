20 july 2017
- rest5envelopes_exh to do exhales only. audited hua 5' rest file separate inhales, exhales. detect peak, 95% energy duration. correlate with SUMMARYDATA from pneumotach. 

21 july 2017
- try above with hoku and kolohe 5' rest files 
- audited to separate exh from inh: 153b, 153c
- realigned files after auditing
- hoku (153b, DQ file 14): works fairly well, still some spikes in envelope, correlation not so clean. Need Resp Timing
- Kolohe (153c, DQ file 15): works fairly well, correlation ehh. Have resp timing.
- Did RESPTIMING for Hua, Hoku. Saved in _resp.mat files 
- DQ ECG data checks: which are good, which are not, which have undergone final check

23 july 2017
- working on ECG data final check for Andreas. 140z and 141y still have to finish

24 july 2017
- rest5envelopes
- found error in plotting for rest5envelopes: wasn't plotting integral of env (duplicate plots in subplot!) 
- integrated audited exhale, too. added to subplot. 
- run for files 13, 14, 15
- had to reaudit Lono 5'rest for exhales only, realigned with exhale only CUE 
- evalcorr.m to evaluate correlation. BUT need to flip correlation x and y: use sound to estimate pneum
- audited all ECG except 141y. Are there two overlapping signals, one lower Freq and one higher Freq? Ughhhhh

10 Aug 2017 [back from vacation]
- added RMSE to evalcorr
- switched axes for regression: use sound to estimate measured params (rest5envelopes_exh)
- fixed RESPTIMING for 153a - overestimated exhalation duration. * still have to do for 153b, 153c * 

11 Aug 2017
- Fixed RESPTIMING for 153b, 153c; re-ran rest5envelopes_exh
- Looked at Trial44 ChestBand, waiting until meeting with Peter and Kristian Monday. 
- Audited gm15_266a for breath counts (and revived surfDetect.m!)

14 Aug 2017
- Finished gm15_266a audit
- Met with Kristian and Peter re: Chest Band and other data. 

15 Aug 2017
- Other ECG files for Andreas: 136z, 144z, 146z [even though poor quality recordings]
- ChestBand Trial22: reselected band peaks, new calculation of prominence
- Calibrated other ChestBand pneumo files, exported, ran through DOLPHIN_FLOW_MR_jvdH. Emailed Austin re: Trial 36. Still have to export-run 60 and 61, but calibrated. 

23 Aug 2017
- ECG waterfall separation to correlate HR magnitude and VT for Andreas - file 138z
- set up directories for Animove 

24 Aug 2017
- SNAK course seminars; got Azores sperm whale data from Pernille, set up directories on PC

12 Sept 2017
- Animove: timestamp issues with Jakob via email for MoveVis
- Mapped out BreathCounts pipeline, checked data for upcoming analysis
- Audited gm15_265a

13 Sept 2017
- Updated gm13_220b audit (overwritten by accident, saved to C:\tag\audit)
- Completed gm13_220b, gm15_265a audits
- Met with Pernille re: sperm whale data
- Click detection for sw193a complete

14 Sept 2017
- Fix duplicate audits cues in breath counts
- Joyplot for breathcounts, including transparency etc. 
- Assign species, colours for breathcounts (assignSpp.m, assignCol.m), new colormap scaled with size
- Set 1s threshold between breaths, removed duplicate breaths.

15 Sept 2017
- Fixed first line CSV problem
- Used real data in PGLS
- Auditing gm11_248c
- Good example of breathing surfacing gm11_248c - screenshot and wav

16 Sept 2017
- Worked on resp detector to see detection rate/false alarm rate for short surfacings. False error rate still high. 
- Finished audit gm11_248c
- ggjoy with log(IBI) all individuals, just BEAUTIFUL. 

17 Sept 2017
- Plotting ggjoy log axes, NEW WEIGHT ESTIMATES

---- Biologging ----
---- Inertial Sensing Course ----

9 Oct 2017 
- Chest Band application to three files. File 61 best. Change to exhale only?

10 Oct 2017
- Tried exhale only, also looked at rest5min again.

12 Oct 2017
- Compared correlation of raw signal vs cleaned signal vs envelope vs 95% energy duration of envelope for 5' rest files. 
- added flow signal to resting pneumotach flow 
- Checked some audits really carefully - does *blip* before exhale considerably affect result?
***** The cleaning may be the issue - does it remove too much of the signal? *****
- Looked at inter-dive IBI for breath counts based on seminar paper for lab meeting
- EXTRACTED 132x DATA FROM TAG! Have to audit in Audition 

13 october
showed this in matlab helpdesk!

---- SMM 2017 ----

6 Nov 
- Renamed all Doug's RW data folders and .dtg to egxxxaxx convention for automation
- Can't audit many of Doug's D2 tags with normal tools as do not have CAL files. BUT have PRH and can therefore just find times to audit in audition
- Backed up all dl and eg tags to AU server 
- Made corrected depth record (tentative prh file) for sw17 deployments. Corrected depth by p*2660-60 as per Mark's recommendation

7 Nov 2017
- Found .xlsx audits for some long DPN eg deployments for BreathCounts. Converted these to cuetab -- DPNauditConvert.m 
- still have to find missed breaths in these deployments. Jerk method underway to detect, but holding off until plans confirmed for mysticete inclusion
- Some auditing of sw17_193a but really tricky...

8 Nov 2017
- intention to look at a few good exercise trials. Chose tt17_139c, then found mismatch between names and logged information. 
These files were offloaded from 401 by Alex Shorter after tag failure, so likely just a renaming issue by accident. Audited all three files from day 139 on tag 401. 
Deduced which file is which, kept names (so as not to confuse things or versions between harddrives). Corrected cal files for all.
- Began to work through Trial17 for MATLAB analysis, have to correct detections for exhalation
- Corrected exhalation times, saved as Trial17_EIcorrected.mat
- Began AlignData_DQ2017 for new file

9 Nov 2017
- aligned tt139b, completed exh-inh audit (on top of normal breath audit)
- REALLY. PRETTY. until intevral >0.1 when things get noisy. EXCELLENT JOB. 
- Matlab analysis for Trial16, corrected detections for exhalation, saved as Trial16_EIcorrected.mat
- Matlab analysis for Trial02, corrected detections for exhalation, saved as Trial02_EIcorrected.mat (on MAC)

10-12 Nov 2017
- Audited and aligned 136a, 138c. All Matlab Analysis for good 401 trials where Pneumo corrected. Coloured by distance from tag. 
- Plotted all 5' rest and ET aligned to date, coloured by distance from blowhole, comparing channels 1 and 2
- plotCorrStore.m after waterfallBreath_ET.m 

15 Nov 2017
- corrected Trial02 and Trial27 for calibration factors for Lono (now within normal range of flows and volumes)
- looked at integrated sound/cumulative sum (kind of like a sound flow volume loop) to see if helps refine noisy breaths? 
- **There is some issue with the index of each cue for audit (to clean)**
- PRH for 144b, 143c
- Lono Trial 43 have to do in two parts: compile after Matlab analysis of pneumotach data

16 Nov 2017
- fixed CUE_R(I(i)) business - still a confusing index system, but unsure what to do with it otherwise. 
- added prediction step for pneum on and pneum off
- VO2estEffect.m: what is the effect of including sound in our estimates of metabolic rate? compare with coarse estimates versus estimates from tidal volume measured
- NEXT STEP: consider this through TIME to get metabolic RATE instead of oxygen PER BREATH. 

17 Nov 2017
- applied VO2estEffect to files 16:27. Have to refine audit of file 27 still
- assessed 'improvement' over constant estimates

20-21 Nov 2017: WHOI Application

22 Nov 2017
- started TAG repository: all tag stuff, including license information from Mark Johnson. 
- Intention is to use this to share files with lab group and set up environment to exchange useful pieces of code, common analyses, etc.

23 Nov 2017
- CUE for File 27 was mixed up, fixed, great improvement to fit (obviously!). A good test to know that correlation does not work when breath alignment is effectively randomized.
- Check CUE alignment for File 24: also has poor correlation - wasn't the issue but some breaths weren't cropped just right
- VO2estEffect for file 24, 27 work well. Now we can quantify by how much sound improves our estimate of VT, especially how it varies through time.

27 Nov 2017
- VO2esteffect visualization improvements and then PresentationTimeline.m to go through the steps of presenting method at SMRU
- Looked back at which deployments in Sarasota we have info on: started waterfallBreathSarasota.m but need acoustics

28 Nov 2017
- Looked at applying waterfallBreath to Sarasota 2014 files where we have flow and sound completed. Not a great relationship for two files 
- Alternative is to use cleanbreath_fun but that seems to overfilter... 
- Met with Laia for updated porpoise audits, short finned pilot whale data and audits
- Met with Pernille for sperm whale click detection for her Part A 
- Included all new harbour porpoise data in countdataload. Added a criteria for  > 7h
- Added humpbacks as entries > 100

29 Nov 2017
- incorporated prediction interval into time plots of measured and sound-estimated tidal volume in a trial
- improved figs (VO2estEffect, Presentationtimeline)
- calculated difference in total VT between methods (VO2estEffect)

30 Nov 2017
- looked back at chest band files. Trial 61: re-audited for exhalation only
- Trial 22: re-audited for exhalation only
- Improved figures 
- Found bug in the matching of indices between band and no pneum. Still just trying to get this to work nicely and to make sense of indices upon indices.

11 Dec 2017
- spent last week in St Andrews doing FHL and Sarasota ECG stuff
- commented and updated the last ECG code to share with Julie Oswald
- checked hyperoodon data from pat3100rick miller 
- killer whale data are all very short...
- finished auditing a sperm whale from azores

13 Dec 2017
- yesterday used respdetector on tt14_127a and checking through detected (and missed) breaths slowly. Stopped at 18215 s (18 h deployment!)
- BreathSounds figure for lab meeting 14 Dec 2017. VO2estEffect and PresentationTimeline adjusted plotting, calculating RMSE for constant TLC VT estimation

14-17 Dec 2017
- Finished tt14_127a with resp detector and full check of data. 
- Checked that bat repository works -- share with Laura [ok actually it doesn't. I can't clone it...]

18 Dec 2017
- Chose gm datasets to round out n = 10 for breathcounts.
- started gm11_250b with automatic detector and then follow-up, stopped at 3100. 
- included all data from Paolo Segre for blue whales, minke whales, fin whales 
- added belugas into countdataload structure
- worked with laura on bat tag: can't see much, maybe something at 4Hz but difficult to decipher so will plan on proper camera protocol in future
- changed some harddrives around so as to only bring *one* back to Vancouver over the holidays 
